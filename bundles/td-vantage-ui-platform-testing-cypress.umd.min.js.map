{"version":3,"sources":["ng://@td-vantage/ui-platform/testing/cypress/cypress.ts"],"names":["BASE_URL","Cypress","config","LOGIN_URL","env","_a","username","password","cy","visit","url","should","request","then","response","loginPageHtml","document","createElement","innerHTML","body","loginForm","querySelector","form","method","action","followRedirect"],"mappings":"idAEMA,EAAmBC,QAAQC,OAAO,WAClCC,EAAoBF,QAAQG,IAAI,oBAQtC,SAAsBC,OAAEC,EAAAD,EAAAC,SAAUC,EAAAF,EAAAE,SAChCC,GAAGC,MAAMT,GACTQ,GAAGE,MAAMC,OAAO,UAAWR,GAC3BK,GAAGI,QAAQ,CACTF,IAAKP,IACJU,KAAI,SAAEC,OACDC,EAA6BC,SAASC,cAAc,QAC1DF,EAAcG,UAAYJ,EAASK,SAC7BC,EAA6BL,EAAcM,cAAc,kBAC1DD,GAGLZ,GAAGI,QAAQ,CACTU,MAAM,EACNC,OAAQ,OACRb,IAAKU,EAAUI,OACfC,gBAAgB,EAChBN,KAAM,CACJb,SAAUA,EACVC,SAAUA,KAEXM,KAAI,WACLL,GAAGC,MAAMT,GACTQ,GAAGE,MAAMC,OAAO,cAAeR,GAC/BK,GAAGE,MAAMC,OAAO,UAAWX,iBAKjC,WACEQ,GAAGC,MAAMT,GACTQ,GAAGC,MAAM,oBACTD,GAAGC,MAAMT,GACTQ,GAAGE,MAAMC,OAAO,UAAWR","sourcesContent":["/// <reference types=\"cypress\" />\n\nconst BASE_URL: string = Cypress.config('baseUrl'); // ex: http://localhost:4200\nconst LOGIN_URL: string = Cypress.env('loginUrl'); // ex: https://vantage.url.io/auth\n\nexport interface ILoginCredentials {\n  username: string;\n  password: string;\n}\n\n// inspired by https://vrockai.github.io/blog/2017/10/28/cypress-keycloak-intregration/\nexport function login({ username, password }: ILoginCredentials): void {\n  cy.visit(BASE_URL);\n  cy.url().should('include', LOGIN_URL);\n  cy.request({\n    url: LOGIN_URL,\n  }).then((response: any) => {\n    const loginPageHtml: HTMLElement = document.createElement('html');\n    loginPageHtml.innerHTML = response.body;\n    const loginForm: HTMLFormElement = loginPageHtml.querySelector('#kc-form-login');\n    if (!loginForm) {\n      return;\n    }\n    cy.request({\n      form: true,\n      method: 'POST',\n      url: loginForm.action,\n      followRedirect: false,\n      body: {\n        username: username,\n        password: password,\n      },\n    }).then(() => {\n      cy.visit(BASE_URL);\n      cy.url().should('not.include', LOGIN_URL);\n      cy.url().should('include', BASE_URL);\n    });\n  });\n}\n\nexport function logout(): void {\n  cy.visit(BASE_URL);\n  cy.visit('/api/user/logout');\n  cy.visit(BASE_URL);\n  cy.url().should('include', LOGIN_URL);\n}\n"]}