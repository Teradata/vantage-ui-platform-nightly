!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@td-vantage/ui-platform/theme",["exports","@angular/core","@angular/common","rxjs","rxjs/operators"],t):t(((e=e||self)["td-vantage"]=e["td-vantage"]||{},e["td-vantage"]["ui-platform"]=e["td-vantage"]["ui-platform"]||{},e["td-vantage"]["ui-platform"].theme={}),e.ng.core,e.ng.common,e.rxjs,e.rxjs.operators)}(this,(function(e,t,r,n,a){"use strict";var i={DARK:"dark-theme",LIGHT:"light-theme"};var o=function(){function e(e,t){var r=this;this.rendererFactory=e,this._document=t,this.preferDarkMediaQuery=window.matchMedia("(prefers-color-scheme: dark)");var o=this.localStorageTheme()||this.checkOSPreference();this._renderer2=e.createRenderer(void 0,void 0),this._activeThemeSubject=new n.BehaviorSubject(o),this.activeTheme$=this._activeThemeSubject.asObservable(),this.darkTheme$=this._activeThemeSubject.asObservable().pipe(a.map((function(e){return e===i.DARK}))),this.lightTheme$=this._activeThemeSubject.asObservable().pipe(a.map((function(e){return e===i.LIGHT}))),this.applyTheme(o,!1);var c=n.fromEventPattern(this.preferDarkMediaQuery.addListener.bind(this.preferDarkMediaQuery),this.preferDarkMediaQuery.removeListener.bind(this.preferDarkMediaQuery)).pipe(a.map((function(e){return e.matches?i.DARK:i.LIGHT}))),u=n.fromEvent(window,"storage").pipe(a.filter((function(e){return"vantage.theme"===e.key})),a.map((function(e){return e.newValue?e.newValue:r.checkOSPreference()})));n.merge(u,c).subscribe((function(e){return r.applyTheme(e)})),window.addEventListener("pageshow",(function(e){var t=r.localStorageTheme(),n=t&&t!==r._activeTheme;e.persisted&&n&&r.applyTheme(t)}))}return Object.defineProperty(e.prototype,"_activeTheme",{get:function(){return this._activeThemeSubject.getValue()},set:function(e){this._activeThemeSubject.next(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"darkThemeIsActive",{get:function(){return this._activeTheme===i.DARK},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lightThemeIsActive",{get:function(){return this._activeTheme===i.LIGHT},enumerable:!0,configurable:!0}),e.prototype.activeTheme=function(){return this._activeTheme},e.prototype.applyLightTheme=function(){return this.applyTheme(i.LIGHT)},e.prototype.applyDarkTheme=function(){return this.applyTheme(i.DARK)},e.prototype.toggleTheme=function(){return this._activeTheme===i.DARK?this.applyLightTheme():this.applyDarkTheme()},e.prototype.map=function(e,t){return this.activeTheme$.pipe(a.map((function(r){return r in e?e[r]:t})))},e.prototype.localStorageTheme=function(){return localStorage.getItem("vantage.theme")},e.prototype.applyTheme=function(e,t){return void 0===t&&(t=!0),this._renderer2.removeClass(this._document.querySelector("html"),e===i.DARK?i.LIGHT:i.DARK),this._renderer2.addClass(this._document.querySelector("html"),e),t&&localStorage.setItem("vantage.theme",e),this._activeTheme=e},e.prototype.checkOSPreference=function(){return this.preferDarkMediaQuery.matches?i.DARK:i.LIGHT},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:t.RendererFactory2},{type:void 0,decorators:[{type:t.Inject,args:[r.DOCUMENT]}]}]},e}();function c(e,t,r){return e||new o(t,r)}var u={provide:o,deps:[[new t.Optional,new t.SkipSelf,o],[t.RendererFactory2],[r.DOCUMENT]],useFactory:c},h=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule],providers:[u]}]}],e}();e.THEME_LOCAL_STORAGE_KEY="vantage.theme",e.VANTAGE_THEME_PROVIDER=u,e.VANTAGE_THEME_PROVIDER_FACTORY=c,e.VantageTheme=i,e.VantageThemeModule=h,e.VantageThemeService=o,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=td-vantage-ui-platform-theme.umd.min.js.map