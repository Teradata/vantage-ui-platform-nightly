{"version":3,"file":"td-vantage-ui-platform-access.umd.js","sources":["ng://@td-vantage/ui-platform/access/guards/block-root-access.guard.ts","ng://@td-vantage/ui-platform/access/guards/block-user-access.guard.ts","ng://@td-vantage/ui-platform/access/access.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\nimport { Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { VantageSessionService, VantageAuthenticationGuard } from '@td-vantage/ui-platform/auth';\n\n/**\n * Guard that checks if the user is root (`admin` flag `true`)\n * to block access into a particular route.\n * If `admin` flag is `true`, then we redirect to `/`\n */\n@Injectable()\nexport class VantageBlockRootAccessGuard implements CanActivate {\n  constructor(private _authGuard: VantageAuthenticationGuard, private _sessionService: VantageSessionService) {}\n\n  canActivate(next: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<boolean> {\n    // pipe through the VantageAuthentication guard to be able to chain guards\n    return this._authGuard.canActivate(next, state).pipe(\n      map(() => {\n        if (this._sessionService.user.admin) {\n          location.replace('/');\n          return false;\n        }\n        return true;\n      }),\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\nimport { Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { VantageSessionService, VantageAuthenticationGuard } from '@td-vantage/ui-platform/auth';\n\n/**\n * Guard that checks if the user is a normal user (`admin` flag `false`)\n * to block access into a particular route.\n * If `admin` flag is `false`, then we redirect to `/`\n */\n@Injectable()\nexport class VantageBlockUserAccessGuard implements CanActivate {\n  constructor(private _authGuard: VantageAuthenticationGuard, private _sessionService: VantageSessionService) {}\n\n  canActivate(next: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<boolean> {\n    // pipe through the VantageAuthentication guard to be able to chain guards\n    return this._authGuard.canActivate(next, state).pipe(\n      map(() => {\n        if (!this._sessionService.user.admin) {\n          location.replace('/');\n          return false;\n        }\n        return true;\n      }),\n    );\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { VantageBlockRootAccessGuard } from './guards/block-root-access.guard';\nimport { VantageBlockUserAccessGuard } from './guards/block-user-access.guard';\n\n@NgModule({\n  imports: [\n    CommonModule,\n  ],\n  providers: [\n    VantageBlockRootAccessGuard,\n    VantageBlockUserAccessGuard,\n  ],\n})\nexport class VantageAccessModule {\n\n}\n"],"names":["map","Injectable","VantageAuthenticationGuard","VantageSessionService","NgModule","CommonModule"],"mappings":";;;;;;;;;;IAAA;;;;;AAYA;QAEE,qCAAoB,UAAsC,EAAU,eAAsC;YAAtF,eAAU,GAAV,UAAU,CAA4B;YAAU,oBAAe,GAAf,eAAe,CAAuB;SAAI;;;;;;QAE9G,iDAAW;;;;;QAAX,UAAY,IAA4B,EAAE,KAA0B;YAApE,iBAWC;;YATC,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,IAAI,CAClDA,aAAG;;;YAAC;gBACF,IAAI,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE;oBACnC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;oBACtB,OAAO,KAAK,CAAC;iBACd;gBACD,OAAO,IAAI,CAAC;aACb,EAAC,CACH,CAAC;SACH;;oBAfFC,eAAU;;;;oBAPqBC,+BAA0B;oBAAjDC,0BAAqB;;QAuB9B,kCAAC;KAhBD;;;;;;ICZA;;;;;AAYA;QAEE,qCAAoB,UAAsC,EAAU,eAAsC;YAAtF,eAAU,GAAV,UAAU,CAA4B;YAAU,oBAAe,GAAf,eAAe,CAAuB;SAAI;;;;;;QAE9G,iDAAW;;;;;QAAX,UAAY,IAA4B,EAAE,KAA0B;YAApE,iBAWC;;YATC,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,IAAI,CAClDH,aAAG;;;YAAC;gBACF,IAAI,CAAC,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE;oBACpC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;oBACtB,OAAO,KAAK,CAAC;iBACd;gBACD,OAAO,IAAI,CAAC;aACb,EAAC,CACH,CAAC;SACH;;oBAfFC,eAAU;;;;oBAPqBC,+BAA0B;oBAAjDC,0BAAqB;;QAuB9B,kCAAC;KAhBD;;;;;;ACZA;QAMA;SAWC;;oBAXAC,aAAQ,SAAC;wBACR,OAAO,EAAE;4BACPC,mBAAY;yBACb;wBACD,SAAS,EAAE;4BACT,2BAA2B;4BAC3B,2BAA2B;yBAC5B;qBACF;;QAGD,0BAAC;KAXD;;;;;;;;;;;;;;"}