{"version":3,"file":"td-vantage-ui-platform-testing-cypress.js","sources":["ng://@td-vantage/ui-platform/testing/cypress/cypress.ts"],"sourcesContent":["/// <reference types=\"cypress\" />\n\nconst BASE_URL: string = Cypress.config('baseUrl'); // ex: http://localhost:4200\nconst LOGIN_URL: string = Cypress.env('loginUrl'); // ex: https://vantage.url.io/auth\n\nexport interface ILoginCredentials {\n  username: string;\n  password: string;\n}\n\n// inspired by https://vrockai.github.io/blog/2017/10/28/cypress-keycloak-intregration/\nexport function login({ username, password }: ILoginCredentials): void {\n  cy.visit(BASE_URL);\n  cy.url().should('include', LOGIN_URL);\n  cy.request({\n    url: LOGIN_URL,\n  }).then((response: any) => {\n    const loginPageHtml: HTMLElement = document.createElement('html');\n    loginPageHtml.innerHTML = response.body;\n    const loginForm: HTMLFormElement = loginPageHtml.querySelector('#kc-form-login');\n    if (!loginForm) {\n      return;\n    }\n    cy.request({\n      form: true,\n      method: 'POST',\n      url: loginForm.action,\n      followRedirect: false,\n      body: {\n        username: username,\n        password: password,\n      },\n    }).then(() => {\n      cy.visit(BASE_URL);\n      cy.url().should('not.include', LOGIN_URL);\n      cy.url().should('include', BASE_URL);\n    });\n  });\n}\n\nexport function logout(): void {\n  cy.visit(BASE_URL);\n  cy.visit('/api/user/logout');\n  cy.visit(BASE_URL);\n  cy.url().should('include', LOGIN_URL);\n}\n"],"names":[],"mappings":";;;;;;;;MAEM,QAAQ,GAAW,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC;;;MAC5C,SAAS,GAAW,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC;;;;;;AAQjD,SAAgB,KAAK,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAqB;IAC7D,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACnB,EAAE,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IACtC,EAAE,CAAC,OAAO,CAAC;QACT,GAAG,EAAE,SAAS;KACf,CAAC,CAAC,IAAI;;;;IAAC,CAAC,QAAa;;cACd,aAAa,GAAgB,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC;QACjE,aAAa,CAAC,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC;;cAClC,SAAS,GAAoB,aAAa,CAAC,aAAa,CAAC,gBAAgB,CAAC;QAChF,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;SACR;QACD,EAAE,CAAC,OAAO,CAAC;YACT,IAAI,EAAE,IAAI;YACV,MAAM,EAAE,MAAM;YACd,GAAG,EAAE,SAAS,CAAC,MAAM;YACrB,cAAc,EAAE,KAAK;YACrB,IAAI,EAAE;gBACJ,QAAQ,EAAE,QAAQ;gBAClB,QAAQ,EAAE,QAAQ;aACnB;SACF,CAAC,CAAC,IAAI;;;QAAC;YACN,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YACnB,EAAE,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,aAAa,EAAE,SAAS,CAAC,CAAC;YAC1C,EAAE,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;SACtC,EAAC,CAAC;KACJ,EAAC,CAAC;CACJ;;;;AAED,SAAgB,MAAM;IACpB,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACnB,EAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;IAC7B,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IACnB,EAAE,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;CACvC;;;;"}