{"version":3,"file":"td-vantage-ui-platform-testing-cypress.js","sources":["ng://@td-vantage/ui-platform/testing/cypress/utility/utility.ts","ng://@td-vantage/ui-platform/testing/cypress/mock/mockutility.ts"],"sourcesContent":["/// <reference types=\"cypress\" />\n\nconst BASE_URL: string = Cypress.config('baseUrl'); // ex: http://localhost:4200\nconst LOGIN_URL: string = Cypress.env('loginUrl'); // ex: https://vantage.url.io/auth\n\nexport interface ILoginCredentials {\n  username: string;\n  password: string;\n}\n\n// inspired by https://vrockai.github.io/blog/2017/10/28/cypress-keycloak-intregration/\nexport function login({ username, password }: ILoginCredentials): void {\n  cy.request({\n    url: LOGIN_URL,\n  }).then((response: any) => {\n    const loginPageHtml: HTMLElement = document.createElement('html');\n    loginPageHtml.innerHTML = response.body;\n    const loginForm: HTMLFormElement = loginPageHtml.querySelector('#kc-form-login');\n    if (loginForm) {\n      cy.request({\n        form: true,\n        method: 'POST',\n        url: loginForm.action,\n        followRedirect: false,\n        body: {\n          username,\n          password,\n        },\n      }).then(() => {\n        _redirectToHome();\n      });\n    } else {\n      _redirectToHome();\n    }\n  });\n}\n\nexport function logout(): void {\n  cy.request('/api/user/logout');\n}\n\nfunction _redirectToHome(): void {\n  cy.visit(BASE_URL);\n  cy.url().should('not.include', LOGIN_URL);\n  cy.url().should('include', BASE_URL);\n}\n\nexport const SSO_COOKIES: string[] = ['USER_SSO_ID', 'XSRF-TOKEN'];\nexport function whiteListSSOCookies(): void {\n  Cypress.Cookies.defaults({ whitelist: SSO_COOKIES });\n}\n\nexport function waitForAngular(): Cypress.Chainable {\n  cy.get('[ng-version]').should('exist');\n  return cy.window().then((win: Window) => {\n    return new Cypress.Promise(\n      (resolve: (thenableOrResult?: {} | PromiseLike<{}>) => void, reject: (error?: any) => void) => {\n        const testabilities: any = win['getAllAngularTestabilities']();\n        if (!testabilities) {\n          return reject(new Error('No testabilities. Is Angular loaded?'));\n        }\n        let count: number = testabilities.length;\n        testabilities.forEach((testability: any) =>\n          testability.whenStable(() => {\n            count--;\n            if (count !== 0) {\n              return;\n            }\n            resolve();\n          }),\n        );\n      },\n    );\n  });\n}\n","/// <reference types=\"cypress\" />\n\ndeclare global {\n  // tslint:disable-next-line\n  namespace Cypress {\n    // tslint:disable-next-line\n    interface Chainable {\n      now(func: string, ...args: any[]): Chainable<Element>;\n    }\n  }\n}\n\nimport { login, logout, ILoginCredentials, waitForAngular } from '../utility/utility';\n\nimport moment from 'moment';\n\nexport enum TestType {\n  'unit' = 'unit',\n  'e2e' = 'e2e',\n}\n\nenum Methods {\n  'GET' = 'GET',\n  'PUT' = 'PUT',\n  'POST' = 'POST',\n  'PATCH' = 'PATCH',\n  'DELETE' = 'DELETE',\n}\n\ninterface IRouteDef {\n  url: string;\n  method: string;\n  status?: number;\n  headers?: any;\n  response?: any;\n  onResponse?: any;\n}\n\ninterface IFixtureRouteDef {\n  alias?: string;\n  status?: number;\n  headers?: any;\n  response?: any;\n  onResponse?: any;\n}\n\nconst allowedHeaders: string[] = ['content-type', 'x-length', 'x-page', 'x-total', 'x-total-pages'];\n\nconst PIPE: string = '|';\nconst SLASH: string = '/';\n\nexport class MockUtility {\n  timestamp: string;\n  recordedURLMethodFixtureMap: Map<string, Map<string, IFixtureRouteDef[]>>;\n  urlMethodFixtureMap: Map<string, IFixtureRouteDef[]>;\n  mocking: boolean = false;\n  recording: boolean = false;\n  testType: TestType;\n  testName: string;\n\n  /**\n   * Method that handles all boilerplate work to set up test.\n   *\n   * @param testName testname used to determine existence of test specific fixtures and\n   * @param testType unit or e2e\n   * @param templates array of templates to be loaded (eg. 'empty' or 'golden')\n   * @param userName user name matching fixture containing credentials\n   * @param record force recording for this test, default is false\n   */\n  setUp(testName: string, testType: TestType, templates: string[], userName: string, record: boolean = false): void {\n    cy.now('log', 'Test: ' + testName + SLASH + testType);\n    this.testName = testName;\n    this.testType = testType;\n\n    // Start server to support routes\n    cy.server();\n\n    // Create timestamp and structures to retain fixture data\n    this.timestamp = moment().format('LTS');\n    this.urlMethodFixtureMap = new Map<string, IFixtureRouteDef[]>();\n    this.recordedURLMethodFixtureMap = new Map<string, Map<string, IFixtureRouteDef[]>>();\n\n    // Conditionally turn on recording\n    if (Cypress.env('record') || record) {\n      this.recording = true;\n\n      cy.now('log', 'Recording...');\n      cy.route({\n        url: '/api/**',\n        onResponse: (xhr: any) => this.recordResponse(xhr),\n      });\n    }\n\n    // Conditionally turn on mocking\n    if (Cypress.env('mock') || testType === TestType.unit) {\n      cy.now('log', 'Mocking...');\n      this.mocking = true;\n    }\n\n    // Add routes for user logon\n    if (this.mocking && !this.recording) {\n      this.registerRoute(userName);\n    }\n    // Load template and test specific routes\n    templates.forEach((template: string) => {\n      this.registerRoute('templates/' + template);\n      this.registerRoute('templates/' + template + SLASH + userName);\n    });\n    this.registerRoute('testspecific/' + testName);\n\n    // Add new route command that alters its behavior based on mode.\n    // If recording or production, just wait.\n    // If mocking, allow returning mock results.\n    Cypress.Commands.add('route2', (routeDef: IRouteDef) => {\n      if (Cypress.env('mock')) {\n        cy.now('log', 'Setting route to mock');\n        cy.route(routeDef);\n      } else {\n        cy.now('log', ' Setting route to alias');\n        cy.route(routeDef.url);\n      }\n    });\n\n    cy.route({\n      method: 'GET',\n      url: '/api/user/logout',\n      status: 200,\n      response: {},\n    });\n\n    // Handle login based on mode.\n    // Mock, bypass login\n    // Otherwise, log in using credentials from fixture.\n    if (this.mocking && !this.recording) {\n      cy.visit('/');\n    } else {\n      cy.fixture('credentials/' + userName).then((credentials: ILoginCredentials) => {\n        login(credentials);\n      });\n    }\n\n    // Wait for page to load\n    waitForAngular();\n  }\n\n  /**\n   * Discover any mock data fixtures under the specified directory hierarchy\n   * and register associated cy.routes.\n   *\n   * @param filename fixture filename\n   */\n  registerRoute(dir: string): void {\n    // Check to see if the file exists.\n    const mockDataFile: string = dir + '/mockdata.json';\n    cy.exec('if [ -f cypress/fixtures/' + mockDataFile + ' ]; then ls cypress/fixtures/' + mockDataFile + '; fi').then(\n      (results: any) => {\n        if (!results.stdout) {\n          return;\n        }\n        cy.fixture(mockDataFile).then((byURLRoutesMap: Map<string, Map<string, IFixtureRouteDef[]>>) => {\n          // Iterate through file processing URL/method mappings\n          // File is a map with URL as the key. Values are maps\n          // in turn, where each map has method as the key value.\n          // The value of these internal maps is an array of responses.\n          Object.keys(byURLRoutesMap).forEach((url: string) => {\n            const byMethodRoutesMap: Map<string, IFixtureRouteDef[]> = byURLRoutesMap[url];\n            Object.keys(byMethodRoutesMap).forEach((method: string) => {\n              const fixtureRouteDefs: IFixtureRouteDef[] = byMethodRoutesMap[method];\n              const urlMethodKey: string = url + PIPE + method;\n              let firstRouteDef: boolean = false;\n              fixtureRouteDefs.forEach((fixtureRouteDef: IFixtureRouteDef) => {\n                // Known mocks supercede recording\n                if (this.mocking) {\n                  if (this.urlMethodFixtureMap.get(urlMethodKey) === undefined) {\n                    this.urlMethodFixtureMap.set(urlMethodKey, []);\n                    firstRouteDef = true;\n                  }\n                  this.urlMethodFixtureMap.get(urlMethodKey).push(fixtureRouteDef);\n\n                  if (firstRouteDef) {\n                    this.registerMockRoute(url, method, fixtureRouteDef);\n                  }\n                } else if (this.recording) {\n                  // onResponse records XHR response\n                  const routeDef: IRouteDef = {\n                    method,\n                    url,\n                    onResponse: (xhr: any) => {\n                      this.recordResponse(xhr);\n                    },\n                  };\n\n                  cy.now('log', 'Registering recording route:');\n                  cy.now('log', 'url/method: ' + url + SLASH + method);\n                  cy.route(routeDef).as(fixtureRouteDef.alias);\n                } else {\n                  const routeDef: IRouteDef = {\n                    method,\n                    url,\n                  };\n\n                  cy.now('log', 'Registering alias route:');\n                  cy.now('log', 'url/method: ' + url + SLASH + method);\n                  cy.now('log', 'alias: ' + fixtureRouteDef.alias);\n                  cy.route(routeDef).as(fixtureRouteDef.alias);\n                }\n              });\n            });\n          });\n        });\n      },\n    );\n  }\n\n  registerMockRoute(url: string, method: string, fixtureRouteDef: IFixtureRouteDef): void {\n    const routeDef: IRouteDef = {\n      url,\n      method,\n      status: fixtureRouteDef.status,\n      headers: fixtureRouteDef.headers,\n      response: fixtureRouteDef.response,\n      onResponse: (xhr: any) => {\n        const responseURL: URL = new URL(xhr.url);\n        const responseKey: string = responseURL.pathname + PIPE + xhr.method;\n        const fixtureRouteDefs: IFixtureRouteDef[] = this.urlMethodFixtureMap.get(responseKey);\n        // If more routes exist, shift old fixture, and re-assign\n        if (fixtureRouteDefs.length > 1) {\n          fixtureRouteDefs.shift();\n          const updatedFixtureRouteDef: IFixtureRouteDef = fixtureRouteDefs[0];\n          this.registerMockRoute(url, method, updatedFixtureRouteDef);\n        }\n      },\n    };\n\n    cy.now('log', 'Registering mock route:');\n    cy.now('log', 'url/method: ' + url + SLASH + method);\n    cy.now('log', 'alias: ' + fixtureRouteDef.alias);\n    cy.now('log', 'status: ' + fixtureRouteDef.status);\n    cy.now('log', 'headers: ' + JSON.stringify(fixtureRouteDef.headers));\n    cy.now('log', 'response: ' + JSON.stringify(fixtureRouteDef.response));\n    cy.route(routeDef).as(fixtureRouteDef.alias);\n  }\n\n  recordResponse(xhr: any): void {\n    // Manipulate URL value to strip host info\n    const url: string = xhr.url.substring(Cypress.config('baseUrl').length);\n    const method: string = xhr.method;\n\n    // Remove black listed headers\n    const headers: any = {};\n    Object.keys(xhr.response.headers).forEach((key: string) => {\n      if (allowedHeaders.indexOf(key) !== -1) {\n        headers[key] = xhr.response.headers[key];\n      }\n    });\n\n    const fixtureRouteDef: IFixtureRouteDef = {\n      alias: url + PIPE + method,\n      status: xhr.status,\n      headers,\n      response: xhr.response.body,\n    };\n\n    if (!this.recordedURLMethodFixtureMap[url]) {\n      this.recordedURLMethodFixtureMap[url] = {};\n    }\n    const byMethodMap: Map<string, IFixtureRouteDef[]> = this.recordedURLMethodFixtureMap[url];\n    if (!byMethodMap[method]) {\n      byMethodMap[method] = [];\n    }\n    cy.now('log', 'Recording response:');\n    cy.now('log', 'url/method: ' + url + SLASH + method);\n    cy.now('log', 'response: ' + JSON.stringify(fixtureRouteDef));\n    byMethodMap[method].push(fixtureRouteDef);\n  }\n\n  tearDown(): void {\n    if (this.recording) {\n      cy.now(\n        'log',\n        'Writing record fixture: ' + 'cypress/recordings/' + this.testName + SLASH + this.timestamp + '/mockdata.json',\n      );\n      cy.now(\n        'writeFile',\n        'cypress/recordings/' + this.testName + SLASH + this.timestamp + '/mockdata.json',\n        this.recordedURLMethodFixtureMap,\n      );\n    }\n    if (!this.mocking) {\n      logout();\n    }\n  }\n}\n"],"names":[],"mappings":"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"}